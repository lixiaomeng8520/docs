Swarm
=====

资料

* `Swarm mode overview <https://docs.docker.com/engine/swarm/>`_

UI

* `docker-swarm-visualizer <https://github.com/dockersamples/docker-swarm-visualizer>`_
* `swarmpit <https://github.com/swarmpit/swarmpit>`_

集群

+----------------------------+--------------------------------------------------------------------------------------------+
| 描述                       | 命令                                                                                       |
+============================+============================================================================================+
| 初始化swarm                | docker swarm init --advertise-addr 192.168.56.20                                           |
+----------------------------+--------------------------------------------------------------------------------------------+
| 获取worker的join-token     | docker swarm join-token worker                                                             |
+----------------------------+--------------------------------------------------------------------------------------------+
| 加入集群                   | docker swarm join --token aaa 192.168.56.20                                                |
+----------------------------+--------------------------------------------------------------------------------------------+

节点

+----------------------------+--------------------------------------------------------------------------------------------+
| 描述                       | 命令                                                                                       |
+============================+============================================================================================+
| 查看节点                   | docker node ls                                                                             |
+----------------------------+--------------------------------------------------------------------------------------------+
| 剔除一个节点               | docker node update --availability drain worker1                                            |
+----------------------------+--------------------------------------------------------------------------------------------+
| 激活一个节点               | docker node update --availability active worker1                                           |
+----------------------------+--------------------------------------------------------------------------------------------+

服务

+----------------------------+--------------------------------------------------------------------------------------------+
| 描述                       | 命令                                                                                       |
+============================+============================================================================================+
| 部署一个服务               | docker service create --replicas 1 --name helloworld alpine ping docker.com                |
+----------------------------+--------------------------------------------------------------------------------------------+
| 查看服务列表               | docker service ls                                                                          |
+----------------------------+--------------------------------------------------------------------------------------------+
| 查看服务详情               | docker service inspect --pretty helloworld                                                 |
+----------------------------+--------------------------------------------------------------------------------------------+
| 查看哪些节点在运行服务     | docker service ps helloworld                                                               |
+----------------------------+--------------------------------------------------------------------------------------------+
| 伸缩服务                   | docker service scale hellowrld=5                                                           |
+----------------------------+--------------------------------------------------------------------------------------------+
| 删除服务                   | docker service rm helloworld                                                               |
+----------------------------+--------------------------------------------------------------------------------------------+
| 升级服务                   | docker service update --image redis:3.0.7 redis                                            |
+----------------------------+--------------------------------------------------------------------------------------------+