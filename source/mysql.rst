Mysql
=====

配置
----

[mysqld]

+----------------------------+--------------------------------------------------------------------------+
| 参数                       | 描述                                                                     |
+============================+==========================================================================+
| skip-grant-tables          | 不再验证授权信息，可以在密码忘记时启用                                   |
+----------------------------+--------------------------------------------------------------------------+

SQL命令
-------

授权

+----------------------------+--------------------------------------------------------------------------+
| 描述                       | 命令                                                                     |
+============================+==========================================================================+
| 创建用户                   | CREATE USER 'user'\@'localhost' IDENTIFIED BY 'admin\@123_S'             |
+----------------------------+--------------------------------------------------------------------------+
|                            | CREATE USER 'user'\@'%' IDENTIFIED BY 'admin\@123_S'                     |
+----------------------------+--------------------------------------------------------------------------+
| 授权                       | GRANT SELECT ON test_db.\* TO 'user'\@'%'                                |
+----------------------------+--------------------------------------------------------------------------+
|                            | GRANT ALL ON test_db.\* TO 'user'\@'%'                                   |
+----------------------------+--------------------------------------------------------------------------+
| 刷新权限                   | flush privileges                                                         |
+----------------------------+--------------------------------------------------------------------------+
| 查看用户的授权             | SHOW GRANTS FOR 'user'\@'%'                                              |
+----------------------------+--------------------------------------------------------------------------+
| 撤销用户权限               | REVOKE SELECT ON test_db.\* FROM 'user'\@'%'                             |
+----------------------------+--------------------------------------------------------------------------+
| 删除用户及权限             | drop user 'user'\@'%'                                                    |
+----------------------------+--------------------------------------------------------------------------+

show status like '';

+----------------------------+----------------------------------------------------------------+
| 变量                       | 描述                                                           |
+============================+================================================================+
| Connections                | 历史所有的连接（成功+失败）                                    |
+----------------------------+----------------------------------------------------------------+
| Threads_created            | 历史所有的连接（成功）                                         |
+----------------------------+----------------------------------------------------------------+
| Threads_connected          | 当前的连接数（有任务+睡眠）（=processlist）                    |
+----------------------------+----------------------------------------------------------------+
| Threads_running            | 当前的连接数（有任务，比如正在运行sql）                        |
+----------------------------+----------------------------------------------------------------+
| Max_used_connections       | 服务器启动后已经同时使用的连接的最大数量                       |
+----------------------------+----------------------------------------------------------------+
|                            |                                                                |
+----------------------------+----------------------------------------------------------------+
|                            |                                                                |
+----------------------------+----------------------------------------------------------------+

Shell命令
---------

导出
^^^^

* `mysql数据的导入导出 <https://www.cnblogs.com/regit/p/8041762.html>`_

导出为sql语句

.. note::

    mysqldump时导出数据库时，如果加上--databases参数，则导出的语句中包含创建数据库

+----------------------------+----------------------------------------------------------------+
| 描述                       | 命令                                                           |
+============================+================================================================+
| 备份所有数据库             | mysqldump -u root -p --all-databases > /path/to/all.sql        |
+----------------------------+----------------------------------------------------------------+
| 备份若干数据库             | mysqldump -u root -p --databases d1 d2 > /path/to/d.sql        |
+----------------------------+----------------------------------------------------------------+
| 备份指定表                 | mysqldump -u root -p d1 t1 > /path/to/d1_t1.sql                |
+----------------------------+----------------------------------------------------------------+
|                            |                                                                |
+----------------------------+----------------------------------------------------------------+
| 导入数据库                 | mysql -u root -p < /path/to/d.sql                              |
+----------------------------+----------------------------------------------------------------+
| 导入到指定数据库           | mysql -u root -p d1 < /path/to/d1_t1.sql                       |
+----------------------------+----------------------------------------------------------------+

导出为自定义格式文本

SELECT * FROM t INTO OUTFILE '/path/to/data.txt' [FIELDS xxx xxx LINES xxx xxx];

+--------------------------------------------+----------------------------------------------------------------+
| 命令参数                                   | 说明                                                           |
+============================================+================================================================+
| fields terminated by '字符'                | 字段分隔符，默认字符为制表符'\t'                               |
+--------------------------------------------+----------------------------------------------------------------+
| fields [optionally] enclosed by '单字符'   | 字段引用符，加上optionally后在数字类型上不会有引用符号         |
+--------------------------------------------+----------------------------------------------------------------+
| fields escaped by '单字符'                 | 转义字符，默认为'\'                                            |
+--------------------------------------------+----------------------------------------------------------------+
| lines starting by '字符'                   | 每行前都加此支付，默认为空                                     |
+--------------------------------------------+----------------------------------------------------------------+
| lines terminated by '字符'                 | 行结束符，默认为'\n'                                           |
+--------------------------------------------+----------------------------------------------------------------+